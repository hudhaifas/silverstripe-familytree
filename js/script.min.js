
jQuery(document).ready(function(){initTree()});var showPerson=function(b){var d="&ajax=1";var c=(b.indexOf(d)===-1)?b+d:b;var a=b.replace(new RegExp(d+"$"),"");$("#tree-loader").show();$("#family-tree").html("");$.ajax(c).done(function(e){$("#tree-holder").html(e);initTree();window.history.pushState({url:a},document.title,a);$("#tree-loader").hide()}).fail(function(e){alert("Error: "+e.responseText)})};var updateInfo=function(a){var c="&ajax=1";var b=(a.indexOf(c)===-1)?a+c:a;$("#info-loader").show();$("#info-body").html("");$.ajax(b).done(function(d){$("#panel-info").html(d);registerLinks();$("#info-loader").hide()}).fail(function(d){alert("Error: "+d.responseText)})};var initTree=function(){$("#family-relations").jOrgChart({chartElement:"#family-tree"});registerLinks();$("#family-tree").dragScroll({});window.onpopstate=function(a){console.log("e: "+a);if(a.state.url){console.log("onpopstate: "+a.state.url);showPerson(a.state.url)}else{a.preventDefault()}}};var registerLinks=function(){$(".node a").click(function(a){a.preventDefault();url=$(this).attr("data-url");updateInfo(url)});$("a.options-item").click(function(a){a.preventDefault();url=($(this).attr("href"));showPerson(url)})};